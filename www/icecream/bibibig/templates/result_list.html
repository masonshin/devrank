{% extends "base.html" %}
{% load devrank_filter %}

{% block head %}
    <script src="{{ STATIC_URL }}resources/js/social.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}resources/js/d3.v3.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}resources/js/bootstrap-modal-fullscreen.js"></script>
    <link href="{{ STATIC_URL }}resources/js/bootstrap-modal-fullscreen.css" rel="stylesheet" />
    <script type="text/javascript">
        $(document).ready(function (){
            $('#search_query').val("{{query}}");
            $(".task").on("click", function(d){
                //$(".task").removeClass('active');
                //$(this).addClass('active');
                $.ajax({
                    type:"POST",
                    url:"/detail",
                    data:{
                            'm':'{{who}}',
                            'w':$(this).attr('id'),
                            'j':'{{results|jsonify|safe}}'
                         },
                    success:function(d){
                        $("#detail-content").html(d);
                    },
                });
            });
        });
    </script>
{% endblock %}

{% block body %}


<div class='container'>
    <div class='row-fluid'>
            <div id="result_search_head" class="span12">
                <a href='/'><img id="logo_pic" src='{{ STATIC_URL }}images/logo.png'></a>
            </div>

            {% if login == True %}
            <form id="search-bt">
                <div id='search-form' class="span12">
                    <div class="input-append">
                        <input  placeholder="Enter Keyword" name='q' type="text" id="search_query" class="search" autocomplete="off"> </input>
                        <button type="submit" class="search btn" id="btn_search">Search</button>
                    </div>
                </div>
            </form>
            <script>
                $("#search-bt").submit(function(e){
                    e.preventDefault();
                    var $form = $( this ),
                    q = $form.find( 'input[name="q"]' ).val(),
                    url = '/home?';
                    window.location = url+'m={{who}}&q='+q;
                });
            </script>
            {% else %}
            <div id="search-bt">
                <a class="btn btn-large btn-info" href="/login/github">
                    <i class="icon-github icon-1x"></i>Login
                </a>
            </div>
            {% endif %}
    </div>
</div>


<div class='container'>
    <div class='row-fluid'>
        <div class="span4">
            {% for result in results %}
              {% include "result.html" %}
            {% endfor %}
        </div>
        <div id="detail-content" class="span8">
            okok.
        </div>
    </div>
</div>
{% endblock %}
