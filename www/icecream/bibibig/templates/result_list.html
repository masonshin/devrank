{% extends "base.html" %}

{% block head %}
    <script src="{{ STATIC_URL }}resources/js/social.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}resources/js/d3.v3.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}resources/js/bootstrap-modal-fullscreen.js"></script>
    <link href="{{ STATIC_URL }}resources/js/bootstrap-modal-fullscreen.css" rel="stylesheet" />
    <script type="text/javascript">
        $(document).ready(function (){
            data = JSON.parse(JSON.stringify({{result_json}}));
            data['me']='{{me}}';

            $('#query').val("{{query}}");
            $(".task").on("click", function(d){
                $(".task").removeClass('active');
                $(this).addClass('active');
                data['who']=$(this).attr('id');
                $.ajax({
                    url:"/detail",
                    type: "POST",
                    data: {'json':JSON.stringify(data)},
                    success: function(d){
                        $("#detail-content").html(d);
                    },
                });
            });
        });
    </script>
{% endblock %}

{% block body %}


<div class='container'>
    <div class='row-fluid'>
            <div id="result_head" class="row">
                <div id="logo" class="span4">
                    <a href='/'><img src='{{ STATIC_URL }}images/logo.png'></a>
                </div>

                <div id="search" class="span8">
                    {% if login == True %}
                    <form class="span10" id="search_form" >
                        <div class="span12 input-append">
                            <input  placeholder="Enter Keyword" name='q' type="text" id="query" class="search" autocomplete="off"> </input>
                            <button type="submit" class="search btn" id="submit">Search</button>
                        </div>
                    </form>
                    <script>
                        $("#search_form").submit(function(e){
                            e.preventDefault();
                            var $form = $( this ),
                            q = $form.find( 'input[name="q"]' ).val(),
                            url = '/home?';
                            window.location = url+'m={{me}}&q='+q;
                        });
                    </script>
                    {% else %}
                    <a class="btn btn-large btn-info" href="/login/github">
                        <i class="icon-github icon-1x"></i>Login
                    </a>
                    {% endif %}
                </div>
            </div>

            <div class="row">
                <div class="span4">
                    {% for result in results %}
                      {% include "result.html" %}
                    {% endfor %}
                </div>
                <div id="detail-content" class="span8"> </div>
            </div>

    </div>
</div>
{% endblock %}
